<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>排行榜 JSON 設定工具 v2.0 (多檔排程版)</title>
    <style>
        :root { --primary-color: #2563eb; --bg-color: #f1f5f9; --card-bg: #ffffff; --border-color: #cbd5e1; --text-color: #0f172a; }
        body { font-family: sans-serif; background-color: var(--bg-color); display: flex; height: 100vh; margin: 0; }
        .sidebar { width: 300px; background: #1e293b; color: white; display: flex; flex-direction: column; }
        .round-list { flex: 1; overflow-y: auto; padding: 10px; }
        .round-item { padding: 12px; margin-bottom: 8px; background: #334155; border-radius: 6px; cursor: pointer; }
        .round-item.active { background: var(--primary-color); }
        .main-content { flex: 1; overflow-y: auto; padding: 25px; }
        .card { background: white; padding: 20px; border-radius: 12px; border: 1px solid var(--border-color); margin-bottom: 20px; }
        .form-group { margin-bottom: 12px; display: flex; flex-direction: column; }
        input, select { padding: 8px; border: 1px solid var(--border-color); border-radius: 4px; }
        .btn { padding: 10px; border-radius: 6px; border: none; cursor: pointer; font-weight: 600; }
        .btn-primary { background: var(--primary-color); color: white; }
        .json-preview { background: #0f172a; color: #38bdf8; padding: 15px; border-radius: 8px; font-family: monospace; white-space: pre; }
    </style>
</head>
<body>
<div class="sidebar">
    <div style="padding:20px;"><button class="btn btn-primary" style="width:100%" onclick="addNewRound()">+ 新增活動</button></div>
    <div class="round-list" id="list_ui"></div>
</div>
<div class="main-content">
    <header style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px">
        <h2 id="title">編輯活動</h2>
        <button class="btn" onclick="cloneRound()">複製活動</button>
    </header>
    <div class="card">
        <div class="form-group"><label>Round ID</label><input type="text" id="round_id" oninput="updateData('round_id', this.value)"></div>
        <div class="form-group"><label>開始時間</label><input type="datetime-local" id="start_dt" onchange="updateDate('start_dt', this.value)"></div>
    </div>
    <div class="card"><h3>預覽</h3><div id="preview" class="json-preview"></div></div>
</div>
<script>
    let rounds = [{round_id: "ROUND_1", start_dt: 202601010000}], cur = 0;
    function renderList() {
        const ui = document.getElementById('list_ui'); ui.innerHTML = '';
        rounds.forEach((r, i) => {
            const div = document.createElement('div'); div.className = `round-item ${i===cur?'active':''}`;
            div.onclick = () => { cur = i; load(); renderList(); };
            div.innerText = r.round_id; ui.appendChild(div);
        });
    }
    function load() { 
        document.getElementById('round_id').value = rounds[cur].round_id;
        const s = String(rounds[cur].start_dt);
        document.getElementById('start_dt').value = `${s.slice(0,4)}-${s.slice(4,6)}-${s.slice(6,8)}T${s.slice(8,10)}:${s.slice(10,12)}`;
        updatePreview();
    }
    function updateData(f, v) { rounds[cur][f] = v; renderList(); updatePreview(); }
    function updateDate(f, v) { rounds[cur][f] = parseInt(v.replace(/[-T:]/g,'')); updatePreview(); }
    function addNewRound() { rounds.push({round_id:"NEW", start_dt:202601010000}); cur=rounds.length-1; renderList(); load(); }
    function cloneRound() { rounds.push({...rounds[cur]}); cur=rounds.length-1; renderList(); load(); }
    function updatePreview() { document.getElementById('preview').innerText = JSON.stringify(rounds[cur], null, 2); }
    renderList(); load();
</script>
</body>
</html>
